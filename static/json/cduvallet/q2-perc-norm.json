{
  "readme": {
    "type": "root",
    "children": [
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "QIIME 2 plugin for percentile normalization to correct for batch effects in microbiome case-control studies."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Read more about the method in our "
          },
          {
            "type": "link",
            "url": "https://doi.org/10.1371/journal.pcbi.1006102",
            "children": [
              {
                "type": "text",
                "value": "paper"
              }
            ]
          },
          {
            "type": "text",
            "value": " (Gibbons et al, PLOS Comp Bio 2018)."
          }
        ]
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Installation instructions"
          }
        ],
        "identifier": "installation-instructions",
        "label": "Installation instructions",
        "html_id": "installation-instructions",
        "implicit": true
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You can install this plugin by cloning this repo and installing manually. (Older versions of the plugin are available on "
          },
          {
            "type": "link",
            "url": "https://anaconda.org/cduvallet/q2_perc_norm",
            "children": [
              {
                "type": "text",
                "value": "conda"
              }
            ]
          },
          {
            "type": "text",
            "value": ", but these are not compatible with pandas >= 2.0)."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You need to have QIIME 2 version 2019.1 or later (though earlier versions of this plugin work with earlier versions of QIIME 2).\nYou need to be in a QIIME 2 environment for this installation to work.\n"
          },
          {
            "type": "link",
            "url": "https://docs.qiime2.org/2019.1/install/",
            "children": [
              {
                "type": "text",
                "value": "Install QIIME 2"
              }
            ]
          },
          {
            "type": "text",
            "value": " and activate the QIIME 2 virtual environment ("
          },
          {
            "type": "inlineCode",
            "value": "source activate qiime2-2019.1"
          },
          {
            "type": "text",
            "value": ") before installing this plugin."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "To install from this repo, clone the repo to your computer, "
          },
          {
            "type": "inlineCode",
            "value": "cd"
          },
          {
            "type": "text",
            "value": " into the main directory, and run:"
          }
        ]
      },
      {
        "type": "code",
        "lang": "",
        "value": "pip install ."
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You can check that the installation worked by typing "
          },
          {
            "type": "inlineCode",
            "value": "qiime"
          },
          {
            "type": "text",
            "value": " on the command line.\nThe "
          },
          {
            "type": "inlineCode",
            "value": "perc-norm"
          },
          {
            "type": "text",
            "value": " plugin should show up in the list of available plugins."
          }
        ]
      },
      {
        "type": "heading",
        "depth": 1,
        "children": [
          {
            "type": "text",
            "value": "Using the plugin"
          }
        ],
        "identifier": "using-the-plugin",
        "label": "Using the plugin",
        "html_id": "using-the-plugin",
        "implicit": true
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The only method in this plugin is "
          },
          {
            "type": "inlineCode",
            "value": "percentile-normalize"
          },
          {
            "type": "text",
            "value": ", which percentile normalizes the abundance of OTUs in case samples with respect to their abundance in control samples."
          }
        ]
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Preparing your data"
          }
        ],
        "identifier": "preparing-your-data",
        "label": "Preparing your data",
        "html_id": "preparing-your-data",
        "implicit": true
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You’ll need to prepare your OTU table and metadata file for use with this plugin.\nYour OTU table should be imported as a "
          },
          {
            "type": "link",
            "url": "https://docs.qiime2.org/2019.1/concepts/#data-files-qiime-2-artifacts",
            "children": [
              {
                "type": "text",
                "value": "QIIME 2 artifact"
              }
            ]
          },
          {
            "type": "text",
            "value": ", with "
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "OTUs in rows"
              }
            ]
          },
          {
            "type": "text",
            "value": " and "
          },
          {
            "type": "strong",
            "children": [
              {
                "type": "text",
                "value": "samples in columns"
              }
            ]
          },
          {
            "type": "text",
            "value": "."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Metadata should be a tab-delimited file with a column that contains samples labeled "
          },
          {
            "type": "inlineCode",
            "value": "case"
          },
          {
            "type": "text",
            "value": " and "
          },
          {
            "type": "inlineCode",
            "value": "control"
          },
          {
            "type": "text",
            "value": ".\nIt can also have a column that labels which batch each sample belongs to.\nIf this column is not specified, then percentile normalization is performed across all cases and controls provided in one go."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "If your OTU table is already a QIIME 2 artifact, you can skip directly to running the code.\nOtherwise, follow the instructions below to use your own tab-delimited OTU table."
          }
        ]
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "Notes on metadata and batch indicators"
          }
        ],
        "identifier": "notes-on-metadata-and-batch-indicators",
        "label": "Notes on metadata and batch indicators",
        "html_id": "notes-on-metadata-and-batch-indicators",
        "implicit": true
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Your metadata file and the file that indicates which samples are in which batch don’t need to be the same file (but can be the same). If you have two files, both need to have the sample IDs in the first column, and these IDs need to match the sample IDs in your OTU table."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The name of the column indicating the case/control status and the batch don’t matter, because you specify them in your call to the percentile normalization function."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The values in the column indicating batches don’t matter, as long as each batch gets a distinct value."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "The values in the column indicating case or control status do matter, and need to be "
          },
          {
            "type": "inlineCode",
            "value": "case"
          },
          {
            "type": "text",
            "value": " or "
          },
          {
            "type": "inlineCode",
            "value": "control"
          },
          {
            "type": "text",
            "value": " exactly."
          }
        ]
      },
      {
        "type": "heading",
        "depth": 3,
        "children": [
          {
            "type": "text",
            "value": "Import tab-delimited OTU table into QIIME 2"
          }
        ],
        "identifier": "import-tab-delimited-otu-table-into-qiime-2",
        "label": "Import tab-delimited OTU table into QIIME 2",
        "html_id": "import-tab-delimited-otu-table-into-qiime-2",
        "implicit": true
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You can use your own OTU table, or make a fake OTU table with "
          },
          {
            "type": "inlineCode",
            "value": "make_fake_data.py"
          },
          {
            "type": "text",
            "value": " in the "
          },
          {
            "type": "inlineCode",
            "value": "test_data/"
          },
          {
            "type": "text",
            "value": " folder here. This creates a fake OTU table and associated metadata file with case/control data (labeled in the “DiseaseState” column) from two different “experiments,” labeled in the “batch” column."
          }
        ]
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "If you’re starting from a text file, you first need to convert the OTU table to biom format before you can import it into QIIME 2."
          }
        ]
      },
      {
        "type": "code",
        "lang": "",
        "value": "biom convert \\\n  -i test_otu_table.transpose.txt \\\n  -o test_otu_table.transpose.biom \\\n  --table-type=\"OTU table\" \\\n  --to-hdf5"
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "Once it’s in biom format, you can import it into QIIME 2, turning it into an artifact:"
          }
        ]
      },
      {
        "type": "code",
        "lang": "",
        "value": "qiime tools import \\\n  --input-path test_otu_table.transpose.biom \\\n  --type 'FeatureTable[RelativeFrequency]' \\\n  --source-format BIOMV210Format \\\n  --output-path test_otu_table.transpose.qza"
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Run percentile normalization"
          }
        ],
        "identifier": "run-percentile-normalization",
        "label": "Run percentile normalization",
        "html_id": "run-percentile-normalization",
        "implicit": true
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "You then run the "
          },
          {
            "type": "inlineCode",
            "value": "percentile-normalize"
          },
          {
            "type": "text",
            "value": " script from the "
          },
          {
            "type": "inlineCode",
            "value": "perc-norm"
          },
          {
            "type": "text",
            "value": " qiime plugin."
          }
        ]
      },
      {
        "type": "code",
        "lang": "",
        "value": "qiime perc-norm percentile-normalize \\\n  --i-table test_otu_table.transpose.qza \\\n  --m-metadata-file test_metadata.txt \\\n  --m-metadata-column DiseaseState \\\n  --o-perc-norm-table test_out.percentile_qiime.qza"
      },
      {
        "type": "paragraph",
        "children": [
          {
            "type": "text",
            "value": "If you have multiple batches in your metadata, you can also use the "
          },
          {
            "type": "inlineCode",
            "value": "--m-batch-file"
          },
          {
            "type": "text",
            "value": " and "
          },
          {
            "type": "inlineCode",
            "value": "--m-batch-column"
          },
          {
            "type": "text",
            "value": " flags to percentile normalize each batch separately."
          }
        ]
      },
      {
        "type": "code",
        "lang": "",
        "value": "qiime perc-norm percentile-normalize \\\n  --i-table test_otu_table.transpose.qza \\\n  --m-metadata-file test_metadata.txt \\\n  --m-metadata-column DiseaseState \\\n  --m-batch-file test_metadata.txt \\\n  --m-batch-column batch \\\n  --o-perc-norm-table test_out.percentile_qiime.qza"
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Versions"
          }
        ],
        "identifier": "versions",
        "label": "Versions",
        "html_id": "versions",
        "implicit": true
      },
      {
        "type": "list",
        "ordered": false,
        "spread": false,
        "children": [
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2023.7.2 - update package to use QIIME 2 template"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2023.7.1 - fix bug related pandas 1.0.0 update"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2019.4.1 - add more informative error in case “control” or “case” label is not found in the metadata"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2019.4 - re-build package with Python 3.6, for compatibility with qiime 2019.1 release and later"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2018.10 - fix conflicting PercentileNormalize type after qiime2 2018.8 release"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2018.4.2 - allow Numeric metadata column to specify batch"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2018.4.1 - add multiple batch handling in "
              },
              {
                "type": "inlineCode",
                "value": "percentile-normalize"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "2018.4.0 - initial plugin"
              }
            ]
          }
        ]
      },
      {
        "type": "heading",
        "depth": 2,
        "children": [
          {
            "type": "text",
            "value": "Dependency conflicts"
          }
        ],
        "identifier": "dependency-conflicts",
        "label": "Dependency conflicts",
        "html_id": "dependency-conflicts",
        "implicit": true
      },
      {
        "type": "list",
        "ordered": false,
        "spread": false,
        "children": [
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "q2-perc-norm versions earlier than 2023.7.1 are not compatible with pandas 1.0 and above."
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "q2-perc-norm versions 2018.* are not compatible with QIIME 2 versions 2019.* and later"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "q2-perc-norm version 2018.10 and later are not compatible with QIIME 2 versions earlier than 2018.8"
              }
            ]
          },
          {
            "type": "listItem",
            "spread": true,
            "children": [
              {
                "type": "text",
                "value": "q2-perc-norm versions 2018.4.* are not compatible with QIIME 2 versions 2018.8 or later"
              }
            ]
          }
        ]
      }
    ]
  },
  "releases": [
    {
      "tag_name": "v2023.7.1",
      "html_url": "https://github.com/cduvallet/q2-perc-norm/releases/tag/v2023.7.1",
      "name": "v2023.7.1 - update for pandas 1.0 and above",
      "published_at": "2023-09-08T21:02:32Z",
      "ast": {
        "type": "root",
        "children": [
          {
            "type": "paragraph",
            "children": [
              {
                "type": "text",
                "value": "Fixed bug related to pandas 1.0 update."
              }
            ]
          }
        ]
      }
    },
    {
      "tag_name": "v2019.1",
      "html_url": "https://github.com/cduvallet/q2-perc-norm/releases/tag/v2019.1",
      "name": "Update for QIIME 2 2019 releases",
      "published_at": "2019-04-25T20:01:10Z",
      "ast": {
        "type": "root",
        "children": [
          {
            "type": "paragraph",
            "children": [
              {
                "type": "text",
                "value": "This re-builds the previous package with Python 3.6, to be compatible with the 2019 and later releases of QIIME 2."
              }
            ]
          }
        ]
      }
    },
    {
      "tag_name": "v1.0",
      "html_url": "https://github.com/cduvallet/q2-perc-norm/releases/tag/v1.0",
      "name": "First working plugin release",
      "published_at": "2018-05-11T16:42:15Z",
      "ast": {
        "type": "root",
        "children": []
      }
    }
  ],
  "owner": "cduvallet",
  "name": "q2-perc-norm",
  "branch": "master",
  "docs": "https://github.com/cduvallet/q2-perc-norm",
  "last_commit": {
    "sha": "f8492bc57378e381cd9558787cba751c4122084a",
    "status": "passed",
    "date": "2025-08-22T21:48:46Z"
  },
  "stars": 10,
  "description": "QIIME2 plugin for percentile normalization to correct for batch effects in microbiome case-control studies",
  "distros": [
    [
      "2025.7",
      "amplicon",
      "environment-files/q2-perc-norm-qiime2-amplicon-2025.7.yml"
    ],
    [
      "2025.7",
      "tiny",
      "environment-files/q2-perc-norm-qiime2-tiny-2025.7.yml"
    ]
  ]
}